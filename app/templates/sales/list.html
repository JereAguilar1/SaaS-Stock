{% extends "base.html" %}

{% block title %}Gestión de Ventas{% endblock %}

{% block page_title %}Gestión de Ventas{% endblock %}

{% block topbar_actions %}
<a href="{{ url_for('sales.new_sale') }}" class="btn-custom btn-primary-custom">
    <i class="bi bi-plus-circle"></i> Nueva Venta
</a>
{% endblock %}

{% block content %}
<!-- Search Form -->
<div class="card-custom" style="margin-bottom: var(--spacing-6);">
    <div class="card-body-custom">
        <form method="GET" action="{{ url_for('sales.list_sales') }}" class="form-row">
            <div style="flex: 1; display: flex; gap: var(--spacing-4); align-items: flex-end;">
                <div style="flex: 1;">
                    <label for="q" class="form-label-custom">Buscar Ventas</label>
                    <div style="position: relative;">
                        <i class="bi bi-search"
                            style="position: absolute; left: 12px; top: 50%; transform: translateY(-50%); color: var(--color-text-muted);"></i>
                        <input type="text" class="form-input-custom" id="q" name="q" value="{{ search_query or '' }}"
                            placeholder="Buscar por ID o monto total" style="padding-left: 36px;"
                            hx-get="{{ url_for('sales.list_sales') }}" hx-trigger="input changed delay:350ms, search"
                            hx-target="#sales-list-container" hx-swap="innerHTML" hx-push-url="true" autocomplete="off">
                    </div>
                </div>
            </div>
        </form>
    </div>
</div>

<!-- Messages Container for HTMX responses -->
<div id="delete-messages" style="margin-bottom: var(--spacing-6);"></div>

<!-- Sales Table Container -->
<div id="sales-list-container">
    {% include 'sales/_list_table.html' %}
</div>
{% endblock %}