{% extends "base.html" %}

{% block title %}{{ 'Editar' if category else 'Nueva' }} Categoría - Sistema de Gestión{% endblock %}

{% block page_title %}{{ 'Editar' if category else 'Nueva' }} Categoría{% endblock %}

{% block topbar_actions %}
<a href="{{ url_for('settings.list_categories') }}" class="btn-custom btn-secondary-custom">
    <i class="bi bi-arrow-left"></i> Volver
</a>
{% endblock %}

{% block content %}
<div style="display: grid; grid-template-columns: 1fr 340px; gap: var(--spacing-6);">
    <div>
        <div class="card-custom">
            <div class="card-header-custom">
                <h2 class="card-title">
                    {{ 'Editar Categoría' if category else 'Crear Nueva Categoría' }}
                </h2>
            </div>
            <div class="card-body-custom">
                <form method="POST">
                    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                    <div class="form-group">
                        <label for="name" class="form-label-custom">
                            Nombre <span style="color: var(--color-danger);">*</span>
                        </label>
                        <input type="text" class="form-input-custom" id="name" name="name"
                            value="{{ category.name if category else '' }}"
                            placeholder="Ej: Ropa, Bebidas, Herramientas" maxlength="120" required autofocus
                            autocomplete="off" hx-post="{{ url_for('settings.check_category_name') }}"
                            hx-trigger="keyup changed delay:500ms" hx-target="#category-name-error-container"
                            hx-swap="outerHTML" hx-include="[name='category_id']">
                        <input type="hidden" name="category_id" value="{{ category.id if category else '' }}">
                        <div id="category-name-error-container"></div>
                        <small
                            style="color: var(--color-text-muted); font-size: var(--font-size-xs); margin-top: var(--spacing-1); display: block;">
                            Nombre de la categoría (máx. 120 caracteres)
                        </small>
                    </div>

                    <div class="alert-custom alert-info" style="margin-top: var(--spacing-4);">
                        <i class="alert-custom-icon bi bi-info-circle"></i>
                        <div class="alert-custom-content">
                            <strong>Ejemplos de categorías:</strong>
                            <ul style="margin: var(--spacing-2) 0 0 0; padding-left: var(--spacing-4);">
                                <li><strong>Ropa</strong> - Remeras, Pantalones, Vestidos.</li>
                                <li><strong>Bebidas</strong> - Gaseosas, Aguas, Jugos.</li>
                                <li><strong>Herramientas</strong> - Manuales, Eléctricas.</li>
                                <li><strong>Almacén</strong> - Comestibles, Limpieza.</li>
                            </ul>
                        </div>
                    </div>

                    <div
                        style="display: flex; justify-content: flex-end; gap: var(--spacing-2); margin-top: var(--spacing-6);">
                        <a href="{{ url_for('settings.list_categories') }}" class="btn-custom btn-secondary-custom">
                            <i class="bi bi-x-circle"></i> Cancelar
                        </a>
                        <button type="submit" id="save-category-btn" class="btn-custom btn-primary-custom">
                            <i class="bi bi-save"></i> {{ 'Actualizar' if category else 'Crear' }}
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <div>
        <div class="card-custom" style="background-color: var(--color-bg-muted);">
            <div class="card-header-custom">
                <h2 class="card-title" style="font-size: var(--font-size-sm);">
                    <i class="bi bi-lightbulb"></i> Consejos
                </h2>
            </div>
            <div class="card-body-custom">
                <h6 style="margin-bottom: var(--spacing-2); font-weight: var(--font-weight-semibold);">¿Para qué sirven
                    las categorías?</h6>
                <p
                    style="font-size: var(--font-size-sm); color: var(--color-text-secondary); margin-bottom: var(--spacing-2);">
                    Las categorías permiten organizar y clasificar los productos para:
                </p>
                <ul
                    style="font-size: var(--font-size-sm); color: var(--color-text-secondary); padding-left: var(--spacing-4); margin-bottom: var(--spacing-4);">
                    <li>Facilitar la búsqueda y navegación</li>
                    <li>Generar reportes por tipo de producto</li>
                    <li>Analizar ventas por categoría</li>
                    <li>Mantener el catálogo ordenado</li>
                </ul>

                <hr style="border-color: var(--color-border-light); margin: var(--spacing-4) 0;">

                <h6 style="margin-bottom: var(--spacing-2); font-weight: var(--font-weight-semibold);">Buenas prácticas:
                </h6>
                <ul
                    style="font-size: var(--font-size-sm); color: var(--color-text-secondary); padding-left: var(--spacing-4); margin-bottom: var(--spacing-4);">
                    <li>Usar nombres claros y descriptivos</li>
                    <li>Evitar categorías demasiado genéricas o específicas</li>
                    <li>Mantener un número manejable de categorías</li>
                    <li>Agrupar productos relacionados</li>
                </ul>

                <hr style="border-color: var(--color-border-light); margin: var(--spacing-4) 0;">

                <h6 style="margin-bottom: var(--spacing-2); font-weight: var(--font-weight-semibold);">Restricciones:
                </h6>
                <ul
                    style="font-size: var(--font-size-sm); color: var(--color-text-secondary); padding-left: var(--spacing-4); margin: 0;">
                    <li>El nombre debe ser único</li>
                    <li>No se puede eliminar si tiene productos asociados</li>
                    <li>Las categorías son opcionales para los productos</li>
                </ul>
            </div>
        </div>
    </div>
</div>
{% endblock %}